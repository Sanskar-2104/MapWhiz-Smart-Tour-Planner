
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}
model User {
  id        String      @id @default(uuid())
  email     String   @unique
  password  String
  name      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // For trip planner: optional fields like trips
  trips     Trip[]
}

model Trip {
  id            String    @id @default(cuid())
  publicId      String    @unique @default(uuid())          // for sharing without exposing DB id
  ownerId       String
  owner         User      @relation(fields: [ownerId], references: [id])
  title         String
  destination   String
  startDate     DateTime
  endDate       DateTime
  interests     String[]   // e.g. ["trekking","food"]
  budget        Int?
  status        String    @default("generated") // draft | generated | published
  days          DailyPlan[]
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  isPublic      Boolean   @default(false)
  sharedCount   Int       @default(0)
}


model DailyPlan {
  // id        String     @id @default(uuid())
  // trip      Trip       @relation(fields: [tripId], references: [id])
  // tripId    String
  // dayNumber Int
  // date      DateTime
  // routes    Json       // efficient route (ordered array of places)
  // places    Place[]    // each day's list of places


  id         String      @id @default(cuid())
  tripId     String
  trip       Trip        @relation(fields: [tripId], references: [id])
  dayIndex   Int         // 1,2,3...
  date       DateTime?
  attractions Place[]
  notes      String?
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
}

model Place {
  id          String   @id @default(uuid())
  dailyPlan     DailyPlan  @relation(fields: [dailyPlanId], references: [id])
  dailyPlanId String
  name        String
  category    String
  address     String
  description String?
  latitude    Float
  longitude   Float
  rating      Float?
  timeSlot    String?  // Morning, Afternoon, Evening
  startTime  String?   // "09:30"
  endTime    String?
  order      Int 
  createdAt   DateTime @default(now())
}
